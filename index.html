<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Calendar Generator - Full Holidays</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --card-bg: rgba(255, 255, 255, 0.9);
            --text-color: #333333;
            --weekend-color: #4a90e2;
            --holiday-color: #e74c3c;
            --columns: 3;
            --card-width: 320px;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0; padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            height: 100vh; display: flex; overflow: hidden;
            background-color: #1a1a1a; color: #fff;
        }

        /* --- Sidebar --- */
        .sidebar {
            width: 360px; min-width: 360px;
            background: #1e1e1e; border-right: 1px solid #333;
            display: flex; flex-direction: column; z-index: 50;
            box-shadow: 5px 0 15px rgba(0,0,0,0.5);
        }

        .sidebar-header {
            padding: 15px 20px; background: #252526; border-bottom: 1px solid #333;
            display: flex; justify-content: space-between; align-items: center; gap: 10px;
        }
        .sidebar-header h2 { margin: 0; font-size: 1rem; color: #eee; flex: 1; }
        
        .lang-btn {
            background: #333; border: 1px solid #555; color: #fff;
            padding: 4px 10px; border-radius: 4px; cursor: pointer; font-size: 0.8rem;
            transition: 0.2s; white-space: nowrap;
        }
        .lang-btn:hover { background: #4a90e2; border-color: #4a90e2; }

        .scroll-content { padding: 20px; overflow-y: auto; flex: 1; }

        .group {
            background: #2d2d2d; border-radius: 8px; padding: 15px;
            margin-bottom: 15px; border: 1px solid #3e3e3e;
        }
        .group-title {
            font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px;
            color: #4a90e2; margin-bottom: 12px; font-weight: 700;
            border-bottom: 1px solid #444; padding-bottom: 5px;
        }

        .control-item { margin-bottom: 12px; }
        .control-item label { display: block; margin-bottom: 5px; font-size: 0.85rem; color: #bbb; }
        
        .val-display { float: right; color: #4a90e2; font-family: monospace; font-weight: bold; }

        select, input[type="text"], input[type="number"] {
            width: 100%; background: #1a1a1a; border: 1px solid #444;
            color: #fff; padding: 8px; border-radius: 4px; outline: none;
        }
        input[type="range"] { width: 100%; cursor: pointer; accent-color: #4a90e2; }

        .file-upload-wrapper { display: flex; gap: 5px; }
        .file-btn {
            flex: 1; background: #333; border: 1px dashed #666; padding: 8px;
            text-align: center; border-radius: 4px; cursor: pointer; font-size: 0.8rem; color: #ccc;
            overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
        }
        .file-btn:hover { border-color: #4a90e2; color: #fff; }
        input[type="file"] { display: none; }
        .icon-btn {
            width: 36px; background: #333; border: 1px solid #444; color: #e74c3c;
            border-radius: 4px; cursor: pointer; font-size: 1rem; display: flex; align-items: center; justify-content: center;
        }

        .btn {
            width: 100%; padding: 12px; border: none; border-radius: 6px;
            font-size: 0.95rem; font-weight: 600; cursor: pointer; transition: 0.2s;
        }
        .btn-primary { background: #4a90e2; color: white; }
        .btn-primary:hover { background: #357abd; }
        
        .color-row { display: flex; align-items: center; justify-content: space-between; }
        input[type="color"] { background: none; border: none; width: 30px; height: 30px; padding: 0; cursor: pointer; }
        input[type="checkbox"] { width: auto; cursor: pointer; transform: scale(1.2); }

        /* --- Preview Area --- */
        .preview-area {
            flex: 1; position: relative;
            background-color: #222; 
            background-image: linear-gradient(45deg, #2a2a2a 25%, transparent 25%), 
                              linear-gradient(-45deg, #2a2a2a 25%, transparent 25%), 
                              linear-gradient(45deg, transparent 75%, #2a2a2a 75%), 
                              linear-gradient(-45deg, transparent 75%, #2a2a2a 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            
            overflow: auto; 
            padding: 40px;
            display: flex; 
            justify-content: flex-start;
            align-items: flex-start;
        }

        #calendar-container {
            margin: auto;
            position: relative;
            width: fit-content;
            height: fit-content;
            background-color: #f0f2f5; 
            box-shadow: 0 0 40px rgba(0,0,0,0.6);
            box-sizing: border-box; 
            overflow: hidden;
            transform-origin: top left;
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        .global-bg-layer {
            position: absolute; top: 0; left: 0; 
            width: 100%; height: 100%; 
            z-index: 1; pointer-events: none;
            background-size: cover; background-position: center;
        }

        .content-layer {
            position: relative; z-index: 10; padding: 50px;
            min-width: fit-content;
        }

        .main-title {
            text-align: center; font-size: 4.5rem; font-weight: 800;
            color: var(--text-color); margin: 0 0 40px 0; letter-spacing: 5px;
            white-space: nowrap; font-family: 'Helvetica Neue', Arial, sans-serif;
            outline: none; text-shadow: 2px 2px 10px rgba(0,0,0,0.1);
        }
        .main-title:focus { border-bottom: 2px dashed #4a90e2; }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(var(--columns), var(--card-width));
            gap: 30px;
        }

        .month-card {
            position: relative;
            background-color: var(--card-bg);
            padding: 20px; border-radius: 12px;
            border: 1px solid rgba(0,0,0,0.05);
            overflow: hidden; isolation: isolate;
        }

        .month-card-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; background-size: cover; background-position: center;
        }
        
        .month-card-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; background-color: var(--card-bg);
        }

        .month-title {
            text-align: center; font-size: 1.5rem; color: var(--text-color);
            margin-bottom: 15px; font-weight: 700; padding-bottom: 10px;
            border-bottom: 2px solid rgba(100,100,100,0.1);
        }

        .days-grid {
            display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; row-gap: 5px;
        }

        .weekday-header {
            font-size: 0.9rem; font-weight: bold; color: var(--text-color); opacity: 0.7; margin-bottom: 8px;
        }

        .day-cell {
            display: flex; flex-direction: column; align-items: center; height: 50px; font-size: 1.1rem; color: var(--text-color);
        }
        .day-cell.weekend .date-num { color: var(--weekend-color); }
        .day-cell.is-holiday .date-num { color: var(--holiday-color); font-weight: bold; }
        .holiday-label {
            font-size: 0.6rem; color: var(--holiday-color); transform: scale(0.85); white-space: nowrap; margin-top: 2px;
        }

        .author-statement {
            margin-top: 40px; text-align: center; font-size: 0.9rem;
            color: var(--text-color); opacity: 0.7; font-weight: 500;
            outline: none; border: 1px dashed transparent; padding: 5px;
        }
        .author-statement:hover, .author-statement:focus { border-color: #4a90e2; opacity: 1; }

        @media (max-width: 900px) {
            body { flex-direction: column; overflow: auto; }
            .sidebar { width: 100%; min-width: 100%; height: auto; border-right: none; }
            #calendar-container { margin: 0; width: 100%; border-radius: 0; }
            .calendar-grid { grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
            .main-title { font-size: 3rem; }
        }
    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>üõ†Ô∏è <span id="ui-app-title">Calendar Gen</span></h2>
            <button class="lang-btn" onclick="toggleUILanguage()">‰∏≠Êñá / English</button>
            <button class="btn-primary" style="width: auto; padding: 5px 10px; font-size: 0.8rem; background:#c0392b;" onclick="resetAll()" id="ui-btn-reset">Reset</button>
        </div>
        
        <div class="scroll-content">
            <!-- 1. ÁºñËæëÁõÆÊ†áÈÄâÊã© -->
            <div class="group" style="border-color: #4a90e2;">
                <div class="group-title" id="ui-step1">Target</div>
                <div class="control-item">
                    <select id="edit-target" onchange="updateUIForTarget()">
                        <option value="global" id="opt-global">üåç Global Background</option>
                        <option disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</option>
                        <option value="0" id="opt-m1">üìÖ January</option>
                        <option value="1" id="opt-m2">üìÖ February</option>
                        <option value="2" id="opt-m3">üìÖ March</option>
                        <option value="3" id="opt-m4">üìÖ April</option>
                        <option value="4" id="opt-m5">üìÖ May</option>
                        <option value="5" id="opt-m6">üìÖ June</option>
                        <option value="6" id="opt-m7">üìÖ July</option>
                        <option value="7" id="opt-m8">üìÖ August</option>
                        <option value="8" id="opt-m9">üìÖ September</option>
                        <option value="9" id="opt-m10">üìÖ October</option>
                        <option value="10" id="opt-m11">üìÖ November</option>
                        <option value="11" id="opt-m12">üìÖ December</option>
                    </select>
                </div>
            </div>

            <!-- 2. ÂõæÁâáÊéßÂà∂ -->
            <div class="group">
                <div class="group-title" id="ui-img-settings">Image Settings</div>
                
                <div class="control-item">
                    <label id="ui-lbl-upload">Upload / Replace</label>
                    <div class="file-upload-wrapper">
                        <label class="file-btn">
                            <span id="upload-status-text">ÁÇπÂáª‰∏ä‰º† Click to upload...</span>
                            <input type="file" id="img-upload" accept="image/*" onchange="handleImageUpload(this)">
                        </label>
                        <button class="icon-btn" onclick="clearTargetImage()" title="Clear">√ó</button>
                    </div>
                </div>

                <div class="control-item">
                    <label>
                        <span id="ui-lbl-opacity">Opacity</span>
                        <span class="val-display" id="disp-img-opacity">100%</span>
                    </label>
                    <input type="range" id="img-opacity" min="0" max="100" value="100" oninput="updateTargetStyle('opacity', this.value)">
                </div>

                <div class="control-item">
                    <label id="ui-lbl-size">Size Mode</label>
                    <select id="img-size" onchange="updateTargetStyle('size', this.value)">
                        <option value="cover" id="opt-size-cover">Cover (Fill)</option>
                        <option value="contain" id="opt-size-contain">Contain (Fit)</option>
                        <option value="100% 100%" id="opt-size-stretch">Stretch</option>
                    </select>
                </div>

                <div class="control-item">
                    <label id="ui-lbl-pos">Position</label>
                    <select id="img-pos" onchange="updateTargetStyle('pos', this.value)">
                        <option value="center" id="opt-pos-center">Center</option>
                        <option value="top" id="opt-pos-top">Top</option>
                        <option value="bottom" id="opt-pos-bottom">Bottom</option>
                        <option value="left" id="opt-pos-left">Left</option>
                        <option value="right" id="opt-pos-right">Right</option>
                    </select>
                </div>
            </div>

            <!-- 3. ÂÖ®Â±ÄÂ∏ÉÂ±Ä -->
            <div class="group">
                <div class="group-title" id="ui-global-style">Global Style</div>
                
                <!-- ÈÄèÊòéÊ®°ÂºèÂºÄÂÖ≥ -->
                <div class="control-item">
                    <label style="display:flex; align-items:center; cursor:pointer;">
                        <input type="checkbox" id="transparent-mode" onchange="toggleTransparentMode(this.checked)" style="margin-right:8px;">
                        <span id="ui-lbl-transparent">Transparent Mode (PNG)</span>
                    </label>
                </div>

                <div class="control-item">
                    <div class="color-row">
                        <label id="ui-lbl-bg-color">Global Bg Color</label>
                        <input type="color" id="global-bg-picker" value="#f0f2f5" oninput="updateWrapperColor(this.value)">
                    </div>
                </div>

                <div class="control-item">
                    <label id="ui-lbl-layout">Columns: <span id="col-display">3</span></label>
                    <input type="range" min="1" max="6" value="3" oninput="updateColumns(this.value)">
                </div>

                <div class="control-item">
                    <label id="ui-lbl-format">Calendar Language</label>
                   <select id="month-format" onchange="renderCalendar()">
    <option value="zh-normal">‰∏≠Êñá (‰∏ÄÊúà)</option>
    <option value="zh-num">Êï∞Â≠ó (1Êúà)</option>
    <option value="en-short">English Short (Jan)</option>
    <option value="en-long">English Long (January)</option>
</select>
                </div>

                <div class="control-item">
                    <div class="color-row">
                        <label id="ui-lbl-card-color">Card Color</label>
                        <input type="color" id="card-bg-picker" value="#ffffff" oninput="updateColor('--card-bg', this.value, true)">
                    </div>
                    <!-- ËíôÂ±ÇÈÄèÊòéÂ∫¶Êï∞ÂÄºÊòæÁ§∫ -->
                    <div style="display:flex; justify-content:space-between; margin-top:5px; font-size:0.8rem; color:#bbb;">
                        <span>Overlay Opacity</span>
                        <span id="disp-card-alpha" style="color:#4a90e2; font-weight:bold;">90%</span>
                    </div>
                    <input type="range" id="card-alpha-slider" min="0" max="255" value="230" style="margin-top:2px;" oninput="updateColor('--card-bg', document.getElementById('card-bg-picker').value, true)">
                </div>

                <div class="control-item">
                    <div class="color-row">
                        <label id="ui-lbl-text-color">Text Color</label>
                        <input type="color" value="#333333" oninput="updateColor('--text-color', this.value)">
                    </div>
                </div>
                
                <!-- Âä†ÂõûÁöÑÂë®Êú´ÂíåËäÇÊó•È¢úËâ≤ËÆæÁΩÆ -->
                <div class="control-item">
                    <div class="color-row">
                        <label id="ui-lbl-weekend-color">Weekend Highlight</label>
                        <input type="color" value="#4a90e2" oninput="updateColor('--weekend-color', this.value)">
                    </div>
                </div>
                 <div class="control-item">
                    <div class="color-row">
                        <label id="ui-lbl-holiday-color">Holiday Highlight</label>
                        <input type="color" value="#e74c3c" oninput="updateColor('--holiday-color', this.value)">
                    </div>
                </div>

            </div>

            <button class="btn btn-primary" id="download-btn" onclick="exportCalendar()">
                üì• Export PNG
            </button>
        </div>
    </aside>

    <main class="preview-area">
        <div id="calendar-container">
            <!-- ÂÖ®Â±ÄËÉåÊôØÂ±Ç -->
            <div class="global-bg-layer" id="global-bg"></div>
            
            <div class="content-layer">
                <h1 class="main-title" contenteditable="true">2026</h1>
                <div class="calendar-grid" id="calendar-grid">
                    <!-- JS ÁîüÊàêÊúà‰ªΩ -->
                </div>
                <!-- ‰ΩúËÄÖÂ£∞Êòé -->
                <div class="author-statement" contenteditable="true" id="author-text">
                    Designed by MyCalendar 2026
                </div>
            </div>
        </div>
    </main>

    <script>
        let currentUILang = 'zh'; 
        
        const UI_TEXT = {
            zh: {
                title: "Êó•ÂéÜÁîüÊàêÂô®", reset: "ÈáçÁΩÆ", step1: "üéØ ÂõæÁâáÂ∫îÁî®", optGlobal: "üåç ÂÖ®Â±ÄÂ§ßËÉåÊôØ",
                months: ["1Êúà", "2Êúà", "3Êúà", "4Êúà", "5Êúà", "6Êúà", "7Êúà", "8Êúà", "9Êúà", "10Êúà", "11Êúà", "12Êúà"],
                imgSettings: "üñºÔ∏è ÂõæÁâáËÆæÁΩÆ", lblUpload: "‰∏ä‰º† / Êõ¥Êç¢ÂõæÁâá", txtUpload: "ÁÇπÂáªÈÄâÊã©ÂõæÁâá...", txtUploaded: "‚úÖ Â∑≤ÊúâÂõæÁâá (ÁÇπÂáªÊõ¥Êç¢)",
                lblOpacity: "ÈÄèÊòéÂ∫¶", lblSize: "Ë£ÅÂàáÊ®°Âºè", lblPos: "ÂØπÈΩê‰ΩçÁΩÆ",
                globalStyle: "üé® ÂÖ®Â±ÄÊ†∑Âºè", lblTransparent: "ÂºÄÂêØÈÄèÊòéÂ∫ï (ÈÄÇÂêàPS/Ë¥¥Âõæ)", lblBgColor: "ÂÖ®Â±ÄÂ∫ïËâ≤",
                lblLayout: "ÊØèË°åÊòæÁ§∫Êúà‰ªΩÊï∞", lblFormat: "Êó•ÂéÜËØ≠Ë®ÄÊ†ºÂºè",
                lblCardColor: "Âç°ÁâáÂ∫ïËâ≤ / ËíôÂ±Ç", lblTextColor: "ÊñáÂ≠óÈ¢úËâ≤", lblWeekend: "Âë®Êú´È´ò‰∫Æ", lblHoliday: "ËäÇÊó•È´ò‰∫Æ",
                btnExport: "üì• ÂØºÂá∫È´òÊ∏Ö PNG", author: "‰ΩúËÄÖÔºöSyuga„ÄÇ‰ªÖÈôêËá™Áî®ÔºåÂïÜÁî®ËØ∑ËÅîÁ≥ªÂ∞èÁ∫¢‰π¶/ÊäñÈü≥ÔºöÂèàËÄÅÂèàËÑÜÂº±ÔºàÁÇπÂáª‰øÆÊîπÊàñÂà†Èô§Ôºâ",
                // ÈÄâÈ°πÁøªËØë
                optCover: "Èì∫Êª° (Cover)", optContain: "ÂÆåÊï¥ (Contain)", optStretch: "Êãâ‰º∏ (Stretch)",
                optCenter: "Â±Ö‰∏≠ (Center)", optTop: "È°∂ÈÉ® (Top)", optBottom: "Â∫ïÈÉ® (Bottom)", optLeft: "Â∑¶‰æß (Left)", optRight: "Âè≥‰æß (Right)"
            },
            en: {
                title: "Calendar Gen", reset: "Reset", step1: "üéØ Target Selection", optGlobal: "üåç Global Background",
                months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                imgSettings: "üñºÔ∏è Image Settings", lblUpload: "Upload / Replace", txtUpload: "ÁÇπÂáª‰∏ä‰º† Click to upload...", txtUploaded: "‚úÖ Image Set (Click change)",
                lblOpacity: "Opacity", lblSize: "Size Mode", lblPos: "Position",
                globalStyle: "üé® Global Style", lblTransparent: "Transparent Mode (No Bg)", lblBgColor: "Global Bg Color",
                lblLayout: "Columns per row", lblFormat: "Calendar Format",
                lblCardColor: "Card Color / Overlay", lblTextColor: "Text Color", lblWeekend: "Weekend Highlight", lblHoliday: "Holiday Highlight",
                btnExport: "üì• Export PNG", author: "Author:Syuga. For personal use only. For commercial use, please contact Xiaohongshu/Douyin:ÂèàËÄÅÂèàËÑÜÂº± (Click to edit or delete)",
                // Options
                optCover: "Cover (Fill)", optContain: "Contain (Fit)", optStretch: "Stretch",
                optCenter: "Center", optTop: "Top", optBottom: "Bottom", optLeft: "Left", optRight: "Right"
            }
        };

        const CAL_DATA = {
            zh: {
                months: ["‰∏ÄÊúà", "‰∫åÊúà", "‰∏âÊúà", "ÂõõÊúà", "‰∫îÊúà", "ÂÖ≠Êúà", "‰∏ÉÊúà", "ÂÖ´Êúà", "‰πùÊúà", "ÂçÅÊúà", "ÂçÅ‰∏ÄÊúà", "ÂçÅ‰∫åÊúà"],
                monthsNum: ["1Êúà", "2Êúà", "3Êúà", "4Êúà", "5Êúà", "6Êúà", "7Êúà", "8Êúà", "9Êúà", "10Êúà", "11Êúà", "12Êúà"],
                weekDays: ["Êó•", "‰∏Ä", "‰∫å", "‰∏â", "Âõõ", "‰∫î", "ÂÖ≠"],
                // 2026Âπ¥ ÂÆåÊï¥ËäÇÊó•ÂàóË°®
                holidays: { 
                    "1-1": "ÂÖÉÊó¶", "1-26": "ËÖäÂÖ´", "2-11": "Â∞èÂπ¥", "2-14": "ÊÉÖ‰∫∫ËäÇ", 
                    "2-16": "Èô§Â§ï", "2-17": "Êò•ËäÇ", "3-3": "ÂÖÉÂÆµ", "3-8": "Â¶áÂ•≥ËäÇ", "3-12": "Ê§çÊ†ëËäÇ",
                    "4-1": "ÊÑö‰∫∫ËäÇ", "4-5": "Ê∏ÖÊòé", "5-1": "Âä≥Âä®ËäÇ", "5-4": "ÈùíÂπ¥ËäÇ", "5-10": "ÊØç‰∫≤ËäÇ", "5-20": "520",
                    "6-1": "ÂÑøÁ´•ËäÇ", "6-19": "Á´ØÂçà", "6-21": "Áà∂‰∫≤ËäÇ", "7-1": "Âª∫ÂÖöËäÇ", "8-1": "Âª∫ÂÜõËäÇ",
                    "8-19": "‰∏ÉÂ§ï", "8-27": "‰∏≠ÂÖÉËäÇ", "9-10": "ÊïôÂ∏àËäÇ", "9-25": "‰∏≠Áßã", 
                    "10-1": "ÂõΩÂ∫Ü", "10-18": "ÈáçÈò≥", "10-31": "‰∏áÂú£Â§ú", "11-26": "ÊÑüÊÅ©ËäÇ",
                    "12-24": "Âπ≥ÂÆâÂ§ú", "12-25": "Âú£ËØû" 
                }
            },
            en: {
                monthsShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
                monthsLong: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                weekDays: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
                // 2026 Full Holidays (En)
                holidays: { 
                    "1-1": "New Year", "1-26": "Laba Fest", "2-14": "Valentine", "2-17": "Lunar NY", 
                    "3-8": "Women's Day", "4-1": "April Fools", "4-5": "Qingming", 
                    "5-1": "Labor Day", "5-10": "Mother's Day", 
                    "6-1": "Children's Day", "6-19": "Dragon Boat", "6-21": "Father's Day", 
                    "8-19": "Qixi", "8-27": "Ghost Fest", "9-25": "Mid-Autumn", 
                    "10-1": "National Day", "10-31": "Halloween", "11-26": "Thanksgiving", 
                    "12-24": "Xmas Eve", "12-25": "Christmas" 
                }
            }
        };

        const defaultState = {
            global: { img: null, opacity: 100, size: 'cover', pos: 'center' },
            months: Array(12).fill(null).map(() => ({ img: null, opacity: 100, size: 'cover', pos: 'center' }))
        };
        let appState = JSON.parse(JSON.stringify(defaultState));
        const year = 2026;

        function init() {
            renderCalendar();
            updateUILanguage();
        }

        function toggleUILanguage() {
            currentUILang = currentUILang === 'zh' ? 'en' : 'zh';
            updateUILanguage();
            updateUIForTarget();
        }

        function updateUILanguage() {
            const txt = UI_TEXT[currentUILang];
            document.getElementById('ui-app-title').innerText = txt.title;
            document.getElementById('ui-btn-reset').innerText = txt.reset;
            document.getElementById('ui-step1').innerText = txt.step1;
            document.getElementById('opt-global').innerText = txt.optGlobal;
            for(let i=0; i<12; i++) document.getElementById(`opt-m${i+1}`).innerText = `üìÖ ${txt.months[i]}`;
            
            document.getElementById('ui-img-settings').innerText = txt.imgSettings;
            document.getElementById('ui-lbl-upload').innerText = txt.lblUpload;
            document.getElementById('ui-lbl-opacity').innerText = txt.lblOpacity;
            document.getElementById('ui-lbl-size').innerText = txt.lblSize;
            document.getElementById('ui-lbl-pos').innerText = txt.lblPos;

            // Update Options Text
            document.getElementById('opt-size-cover').innerText = txt.optCover;
            document.getElementById('opt-size-contain').innerText = txt.optContain;
            document.getElementById('opt-size-stretch').innerText = txt.optStretch;
            document.getElementById('opt-pos-center').innerText = txt.optCenter;
            document.getElementById('opt-pos-top').innerText = txt.optTop;
            document.getElementById('opt-pos-bottom').innerText = txt.optBottom;
            document.getElementById('opt-pos-left').innerText = txt.optLeft;
            document.getElementById('opt-pos-right').innerText = txt.optRight;

            document.getElementById('ui-global-style').innerText = txt.globalStyle;
            document.getElementById('ui-lbl-transparent').innerText = txt.lblTransparent;
            document.getElementById('ui-lbl-bg-color').innerText = txt.lblBgColor;
            document.getElementById('ui-lbl-layout').childNodes[0].nodeValue = txt.lblLayout + ": ";
            document.getElementById('ui-lbl-format').innerText = txt.lblFormat;
            document.getElementById('ui-lbl-card-color').innerText = txt.lblCardColor;
            document.getElementById('ui-lbl-text-color').innerText = txt.lblTextColor;
            document.getElementById('ui-lbl-weekend-color').innerText = txt.lblWeekend;
            document.getElementById('ui-lbl-holiday-color').innerText = txt.lblHoliday;
            
            document.getElementById('download-btn').innerText = txt.btnExport;
            
            const authorDiv = document.getElementById('author-text');
            if(authorDiv.innerText.includes("Designed by") || authorDiv.innerText.includes("Êó•ÂéÜËÆæËÆ°")) {
                authorDiv.innerText = txt.author;
            }
        }

        function renderCalendar() {
            const grid = document.getElementById('calendar-grid');
            grid.innerHTML = '';
            const format = document.getElementById('month-format').value;
            let monthLabels, weekData, holidayData;

            if (format.startsWith('zh')) {
                weekData = CAL_DATA.zh.weekDays;
                holidayData = CAL_DATA.zh.holidays;
                monthLabels = format === 'zh-num' ? CAL_DATA.zh.monthsNum : CAL_DATA.zh.months;
            } else {
                weekData = CAL_DATA.en.weekDays;
                holidayData = CAL_DATA.en.holidays;
                monthLabels = format === 'en-short' ? CAL_DATA.en.monthsShort : CAL_DATA.en.monthsLong;
            }

            for (let i = 0; i < 12; i++) {
                const monthCard = document.createElement('div');
                monthCard.className = 'month-card';
                monthCard.id = `month-card-${i}`;

                const bgLayer = document.createElement('div');
                bgLayer.className = 'month-card-bg';
                bgLayer.id = `month-bg-${i}`;
                const mState = appState.months[i];
                if(mState.img) {
                    bgLayer.style.backgroundImage = `url(${mState.img})`;
                    bgLayer.style.opacity = mState.opacity / 100;
                    bgLayer.style.backgroundSize = mState.size;
                    bgLayer.style.backgroundPosition = mState.pos;
                }
                monthCard.appendChild(bgLayer);

                const overlay = document.createElement('div');
                overlay.className = 'month-card-overlay';
                monthCard.appendChild(overlay);

                const title = document.createElement('div');
                title.className = 'month-title';
                title.innerText = monthLabels[i];
                monthCard.appendChild(title);

                const daysDiv = document.createElement('div');
                daysDiv.className = 'days-grid';

                weekData.forEach(d => {
                    const h = document.createElement('div');
                    h.className = 'weekday-header';
                    h.innerText = d;
                    daysDiv.appendChild(h);
                });

                const firstDay = new Date(year, i, 1).getDay();
                const daysInMonth = new Date(year, i+1, 0).getDate();
                for(let j=0; j<firstDay; j++) daysDiv.appendChild(document.createElement('div'));

                for(let d=1; d<=daysInMonth; d++) {
                    const cell = document.createElement('div');
                    cell.className = 'day-cell';
                    const wd = new Date(year, i, d).getDay();
                    if(wd===0 || wd===6) cell.classList.add('weekend');
                    const num = document.createElement('span');
                    num.className = 'date-num';
                    num.innerText = d;
                    cell.appendChild(num);
                    const key = `${i+1}-${d}`;
                    if(holidayData[key]) {
                        cell.classList.add('is-holiday');
                        const lbl = document.createElement('span');
                        lbl.className = 'holiday-label';
                        lbl.innerText = holidayData[key];
                        cell.appendChild(lbl);
                    }
                    daysDiv.appendChild(cell);
                }
                monthCard.appendChild(daysDiv);
                grid.appendChild(monthCard);
            }

            const gBg = document.getElementById('global-bg');
            const gState = appState.global;
            if (gState.img) {
                gBg.style.backgroundImage = `url(${gState.img})`;
                gBg.style.opacity = gState.opacity / 100;
                gBg.style.backgroundSize = gState.size;
                gBg.style.backgroundPosition = gState.pos;
            } else {
                gBg.style.backgroundImage = 'none';
            }
        }

        function getCurrentTarget() { return document.getElementById('edit-target').value; }
        function updateUIForTarget() {
            const target = getCurrentTarget();
            let state = target === 'global' ? appState.global : appState.months[parseInt(target)];
            const status = document.getElementById('upload-status-text');
            const txt = UI_TEXT[currentUILang];

            document.getElementById('img-opacity').value = state.opacity;
            // Êõ¥Êñ∞ÂõæÁâáÈÄèÊòéÂ∫¶Êï∞ÂÄºÊòæÁ§∫
            document.getElementById('disp-img-opacity').innerText = state.opacity + '%';

            document.getElementById('img-size').value = state.size;
            document.getElementById('img-pos').value = state.pos;
            
            if (state.img) {
                status.innerText = txt.txtUploaded;
                status.style.color = "#4a90e2";
            } else {
                status.innerText = txt.txtUpload;
                status.style.color = "#ccc";
            }
        }
        function handleImageUpload(input) {
            const file = input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                const target = getCurrentTarget();
                if (target === 'global') appState.global.img = e.target.result;
                else appState.months[parseInt(target)].img = e.target.result;
                renderCalendar();
                updateUIForTarget();
                input.value = '';
            };
            reader.readAsDataURL(file);
        }
        function clearTargetImage() {
            const target = getCurrentTarget();
            if (target === 'global') appState.global.img = null;
            else appState.months[parseInt(target)].img = null;
            renderCalendar();
            updateUIForTarget();
        }
        function updateTargetStyle(prop, value) {
            const target = getCurrentTarget();
            const state = target === 'global' ? appState.global : appState.months[parseInt(target)];
            const domEl = target === 'global' ? document.getElementById('global-bg') : document.getElementById(`month-bg-${target}`);
            state[prop] = value;
            
            if (prop === 'opacity') {
                domEl.style.opacity = value / 100;
                // ÂÆûÊó∂Êõ¥Êñ∞Êï∞ÂÄº
                document.getElementById('disp-img-opacity').innerText = value + '%';
            }
            if (prop === 'size') domEl.style.backgroundSize = value;
            if (prop === 'pos') domEl.style.backgroundPosition = value;
        }
        
        function toggleTransparentMode(checked) {
            const container = document.getElementById('calendar-container');
            const picker = document.getElementById('global-bg-picker');
            
            if(checked) {
                container.style.backgroundColor = 'transparent';
                container.style.boxShadow = 'none';
            } else {
                container.style.backgroundColor = picker.value;
                container.style.boxShadow = '0 0 40px rgba(0,0,0,0.6)';
            }
        }

        function updateWrapperColor(hex) {
            const container = document.getElementById('calendar-container');
            const checkBox = document.getElementById('transparent-mode');
            if(checkBox.checked) {
                checkBox.checked = false;
                container.style.boxShadow = '0 0 40px rgba(0,0,0,0.6)';
            }
            container.style.backgroundColor = hex;
        }

        function updateColor(varName, hexValue, isCardBg = false) {
            let finalValue = hexValue;
            if (isCardBg) {
                const alpha = document.getElementById('card-alpha-slider').value;
                // Êõ¥Êñ∞ÊòæÁ§∫
                const pct = Math.round((alpha / 255) * 100);
                document.getElementById('disp-card-alpha').innerText = pct + '%';
                
                const r = parseInt(hexValue.slice(1, 3), 16);
                const g = parseInt(hexValue.slice(3, 5), 16);
                const b = parseInt(hexValue.slice(5, 7), 16);
                finalValue = `rgba(${r}, ${g}, ${b}, ${alpha / 255})`;
            }
            document.documentElement.style.setProperty(varName, finalValue);
        }
        function updateColumns(val) {
            document.documentElement.style.setProperty('--columns', val);
            document.getElementById('col-display').innerText = val;
        }
        function resetAll() {
            if(confirm("Reset all settings?")) {
                appState = JSON.parse(JSON.stringify(defaultState));
                // ÈáçÁΩÆÈ¢úËâ≤Êï∞ÂÄºÊòæÁ§∫
                document.getElementById('card-alpha-slider').value = 230;
                document.getElementById('disp-card-alpha').innerText = '90%';
                
                updateColor('--card-bg', '#ffffff', false); 
                document.documentElement.style.setProperty('--card-bg', 'rgba(255,255,255,0.9)');
                document.documentElement.style.setProperty('--columns', 3);
                document.getElementById('transparent-mode').checked = false;
                document.getElementById('calendar-container').style.backgroundColor = '#f0f2f5';
                document.getElementById('calendar-container').style.boxShadow = '0 0 40px rgba(0,0,0,0.6)';
                document.getElementById('global-bg-picker').value = '#f0f2f5';
                
                renderCalendar();
                updateUIForTarget();
            }
        }

        function exportCalendar() {
            const original = document.getElementById("calendar-container");
            const btn = document.getElementById('download-btn');
            
            const originalText = btn.innerText;
            btn.innerText = "‚è≥ Processing...";
            btn.disabled = true;

            const clone = original.cloneNode(true);
            const wrapper = document.createElement('div');
            wrapper.style.position = 'fixed';
            wrapper.style.top = '-10000px';
            wrapper.style.left = '-10000px';
            wrapper.style.zIndex = '-1000';
            
            const realWidth = original.scrollWidth;
            const realHeight = original.scrollHeight;
            
            clone.style.width = realWidth + 'px';
            clone.style.height = realHeight + 'px';
            clone.style.margin = '0';
            clone.style.transform = 'none';
            clone.style.overflow = 'hidden'; 
            
            wrapper.appendChild(clone);
            document.body.appendChild(wrapper);

            html2canvas(clone, {
                scale: 2, 
                useCORS: true,
                backgroundColor: null,
                width: realWidth,
                height: realHeight,
                windowWidth: realWidth,
                windowHeight: realHeight
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `Calendar_2026_${new Date().getTime()}.png`;
                link.href = canvas.toDataURL("image/png");
                link.click();
                
                document.body.removeChild(wrapper);
                btn.innerText = originalText;
                btn.disabled = false;
            }).catch(err => {
                console.error(err);
                alert("Export Failed.");
                if(document.body.contains(wrapper)) document.body.removeChild(wrapper);
                btn.innerText = originalText;
                btn.disabled = false;
            });
        }

        init();
    </script>
</body>
</html>
